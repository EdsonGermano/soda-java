{"name":"Soda-java","tagline":"This is the Java API for the SODA 2.0 API","body":"soda-java\r\n=========\r\n\r\nThis is the Java API for the Socrata Open Data API (SODA).  You can look at the devloper site (http://dev.socrata.com/) for\r\na deeper discussion of the underlying protocol.\r\n\r\nThe API is broken into several logical parts:\r\n\r\n* The **Producer** api provides functions to add/update/delete objects for datasets that are updated frequently, or for updates\r\nthat are small.  The advantage of this api is that the changes do NOT requre a working copy or to use the publishing cycle\r\nat all, so there is no overhead of copying the dataset data around.\r\n* The **Consumer** api provides a rich, simple query language called SoQL.  SoQL is based off of SQL, and the Consumer\r\napi provides methods to build, execute and consume the results for these queries.\r\n* The **Workflow** api provides functions for creating and publishing working copies of datasets.  These are required for\r\nany changes in a dataset's schema or for the large, bulk changes using the import API\r\n* The **DDL** api provides functions for creating/updating/deleting datasets or columns on datasets.\r\n* The **Import** api provides functions for importing files into datasets.  This can be used for creating\r\na dataset as well as replacing or appending to datasets.\r\n\r\n\r\nThis library is built using two \"Layers\" or interaction.  The HttpLowLevel class takes care of much of the common\r\nHTTP and URL wrangling required by SODA, but does not deal with any unmarshalling of results.\r\n\r\nThe Soda2Consumer, Soda2Producer, SodaDdl, SodaImporter and SodaWorkflow classes are built on top of the HttpLowLevel class.  They build upon it to\r\nuse Jackson to do marshalling from the JSON to Java Objects.\r\n\r\nIf you want to actually see any of these examples working.  You can take a look at the class `com.socrata.ExamplesTest`\r\nin the test directory, which has a working version of these examples.\r\n\r\nConsumer\r\n--------\r\n\r\n**Simple Query**\r\n\r\nThe consumer API is simple.  The following example will issue two requests, one will return the results from the \"test-data\" dataset,\r\nas the JSON string.  The other will return the results as the `Nomination` java objects:\r\n\r\n    Soda2Consumer consumer = Soda2Consumer.newConsumer(\"https://sandbox.demo.socrata.com\", \"testuser@gmail.com\", \"OpenData\", \"D8Atrg62F2j017ZTdkMpuZ9vY\");\r\n\r\n    //To get a raw String of the results\r\n    ClientResponse response = consumer.getHttpLowLevel().query(\"nominationsCopy\", HttpLowLevel.JSON_TYPE, SoqlQuery.SELECT_ALL);\r\n    String payload = response.getEntity(String.class);\r\n    System.out.println(payload);\r\n\r\n    //Get get this automatcally serialized into a set of Java Beans annotated with Jackson JOSN annotations\r\n    List<Nomination> nominations = consumer.query(\"nominationsCopy\", SoqlQuery.SELECT_ALL, Nomination.LIST_TYPE);\r\n    TestCase.assertTrue(nominations.size() > 0);\r\n    System.out.println(nominations.size());\r\n\r\n\r\n**Building Queries**\r\n\r\nAlong with the consumer API, is a builder class to make it easier to build the SoQL queries.  For example, to query for the name, position and nomination date of\r\nnominees for the Department of State, sorted by position:\r\n\r\n    //Create a SoQL query to find the nominations for the Department of State\r\n    SoqlQuery   departmentOfStateQuery = new SoqlQueryBuilder()\r\n            .addSelectPhrase(\"name\")\r\n            .addSelectPhrase(\"position\")\r\n            .addSelectPhrase(\"nomination_date\")\r\n            .setWhereClause(\"agency_name='Department of State'\")\r\n            .addOrderByPhrase(new OrderByClause(SortOrder.Descending, \"position\"))\r\n            .build();\r\n    nominations = consumer.query(\"nominationsCopy\", departmentOfStateQuery, Nomination.LIST_TYPE);\r\n\r\n\r\nProducer\r\n--------\r\n\r\nA \"Producer\" is an object that allows us to actually add, remove or modify rows in Socrata.  To do these operations, you\r\nsimply need to get an instance of a `Soda2Producer`.  This is similar to the earlier `Soda2Consumer` class with the\r\naddition CUD operations.\r\n\r\n\r\n**CRUD on Objects**\r\n\r\nSODA2 also provides mechanisms for creating, updating or deleting individual rows.  In this example, we will add, update and then\r\ndelete Nomninations for a dataset that has test White House Appointee Nominations in it.\r\n\r\n    final Nomination NOMINATION_TO_ADD = new Nomination(\r\n            \"New, User\", \"Imaginary Friend\", \"Department of Imagination\", null, new Date(), null, null, null\r\n    );\r\n\r\n    //This is the White Nomination Java Bean, that I want to update to\r\n    final Nomination NOMINATION_TO_UPDATE = new Nomination(\r\n            \"New, User\", \"Imaginary Friend\", \"Department of Imagination\", null, new Date(), new Date(), true, null\r\n    );\r\n\r\n\r\n    //Get the producer class to allow updates of the data set.\r\n    final Soda2Producer producer = Soda2Producer.newProducer(\"https://sandbox.demo.socrata.com\", \"testuser@gmail.com\", \"OpenData\", \"D8Atrg62F2j017ZTdkMpuZ9vY\");\r\n\r\n    //Get get this automatically serialized into a set of Java Beans annotated with Jackson JOSN annotations\r\n    Meta nominationAddedMeta = producer.addObject(\"testupdate\", NOMINATION_TO_ADD);\r\n\r\n    //Update the nomination\r\n    Meta nominationUpdatedMeta = producer.update(\"testupdate\", nominationAddedMeta.getId(), NOMINATION_TO_UPDATE);\r\n\r\n    //Delete the nomination\r\n    producer.delete(\"testupdate\", nominationUpdatedMeta.getId());\r\n\r\n\r\n**Upsert based on a stream**\r\n\r\nThe library also allows callers to upsert based on a CSV file or stream.\r\n\r\n    Soda2Producer producer = Soda2Producer.newProducer(\"https://sandbox.demo.socrata.com\", \"testuser@gmail.com\", \"OpenData\", \"D8Atrg62F2j017ZTdkMpuZ9vY\");\r\n\r\n    InputStream inputStream = getClass().getResourceAsStream(\"/testNominations.csv\");\r\n    UpsertResult upsertResult = producer.upsertStream(\"testupdate\", HttpLowLevel.CSV_TYPE, inputStream);\r\n\r\n\r\n**Easiest way to import a CSV file**\r\n\r\nThe library makes it simple to upload a CSV file and create a new dataset.\r\n\r\n        final SodaImporter    importer = SodaImporter.newImporter(\"https://sandbox.demo.socrata.com\", \"testuser@gmail.com\", \"OpenData\", \"D8Atrg62F2j017ZTdkMpuZ9vY\");\r\n\r\n        //Create the dataset from the CSV and set the RowColumnIdentifier to \"name\"\r\n        final DatasetInfo     nominationsDataset = importer.createViewFromCsv(uniqueName, \"This is a test dataset using samples with the nominations schema\", NOMINATIONS_CSV, \"Name\");\r\n        importer.publish(nominationsDataset.getId());\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}